<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{headers :: headers}"></head>

<body>
<nav th:replace="~{navbar :: navbar}"></nav>
<!-- TODO add filter by results -->
<!-- TODO add sorting -->
<div class="container" th:fragment="refreshable">
    <div th:each="user : ${result.keySet()}">
        <div class="pair" th:each="friend: ${result.get(user)}">
            <a th:href="@{https://vk.com/__${'id' + user.getId()}__}"
               th:target="_blank">
                <div class="left-person">
                    <div><img class="photo" th:src="${user.getPhotoUri()}"></div>
                    <div th:text="${user.getLastName() + ' ' + user.getFirstName()}"></div>
                </div>
            </a>
            <a th:href="@{https://vk.com/__${'id' + friend.getId()}__}"
               th:target="_blank">
                <div class="right-person">
                    <div><img class="photo" th:src="${friend.getPhotoUri()}"></div>
                    <div th:text="${friend.getLastName() + ' ' + friend.getFirstName()}"></div>
                </div>
            </a>
        </div>
    </div>

</div>
<script>
    let i = 30
    setInterval(() => {
        $('#timer').html(`Results will be updated again in ${--i} seconds`)
        if (i <= 0) {
            i = 30
        }
    }, 1000)
    setInterval(() => {
        $('#refreshable').load("/refresh")
        console.log("Refresh results")
    }, 30000)
</script>
</body>
</html>